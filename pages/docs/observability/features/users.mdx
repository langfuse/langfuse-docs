---
description: User-level LLM observability to track token usage, usage volume and individual user feedback.
sidebarTitle: User Tracking
---

import { PropagationRestrictionsCallout } from "@/components/PropagationRestrictionsCallout";

# User Tracking

The Users view provides an overview of all users. It also offers an in-depth look into individual users.

<Video
  src="https://static.langfuse.com/docs-videos/tracing-users.mp4"
  aspectRatio={1696 / 1080}
  gifStyle
/>

It's easy to map data in Langfuse to individual users. Just pass a unique identifier as the `userId` when you create a `trace`. This can be a username, email, or any other unique identifier. The `userId` is optional, but using it helps you get more from Langfuse. See the integration docs to learn more.

<LangTabs items={["Python SDK", "JS/TS SDK", "OpenAI (Python)", "Langchain (Python)", "Langchain (JS/TS)", "Flowise"]}>
<Tab>
When using the `@observe()` decorator:

```python
from langfuse import observe, propagate_attributes

@observe()
def process_user_request(user_query):
    # Propagate user_id to all child spans
    with propagate_attributes(user_id="user_12345"):
        # All nested operations automatically inherit user_id
        result = process_query(user_query)
        return result
```

When creating spans directly:

```python
from langfuse import get_client, propagate_attributes

langfuse = get_client()

with langfuse.start_as_current_span(
    name="process-user-request"
) as root_span:
    # Propagate user_id to all child spans
    with propagate_attributes(user_id="user_12345"):
        # All spans created here automatically have user_id
        with root_span.start_as_current_generation(
            name="generate-response",
            model="gpt-4o"
        ) as gen:
            # This generation automatically has user_id
            pass
```

</Tab>
<Tab title="JS/TS SDK">

When using the context manager:

```ts
import {
  startActiveObservation,
  propagateAttributes,
} from "@langfuse/tracing";

await startActiveObservation("context-manager", async (span) => {
  span.update({
    input: { query: "What is the capital of France?" },
  });

  // Propagate userId to all child spans
  await propagateAttributes({
    userId: "user-123",
  }, async () => {
    // All spans created here automatically have userId
    // ... your logic ...
  });
});
```

When using the `observe` wrapper:

```ts
import { observe, propagateAttributes } from "@langfuse/tracing";

// An existing function
const processUserRequest = observe(async (userQuery: string) => {
  // Propagate userId to all child spans
  return await propagateAttributes(
    { userId: "user-123" },
    async () => {
      // All nested operations automatically inherit userId
      const result = await processQuery(userQuery);
      return result;
    }
  );
}, { name: "process-user-request" });

const result = await processUserRequest("some query");
```

See [JS/TS SDK docs](/docs/sdk/typescript/guide) for more details.

</Tab>
<Tab>

```python
from langfuse import get_client, propagate_attributes
from langfuse.openai import openai

langfuse = get_client()

with langfuse.start_as_current_span(name="openai-call"):
    # Propagate user_id to all spans including OpenAI generation
    with propagate_attributes(user_id="user_12345"):
        completion = openai.chat.completions.create(
            name="test-chat",
            model="gpt-3.5-turbo",
            messages=[
                {"role": "system", "content": "You are a calculator."},
                {"role": "user", "content": "1 + 1 = "}
            ],
            temperature=0,
        )
```

</Tab>
<Tab title="Langchain (Python)">

Use `propagate_attributes()` with the CallbackHandler:

```python
from langfuse import get_client, propagate_attributes
from langfuse.langchain import CallbackHandler

langfuse = get_client()
handler = CallbackHandler()

with langfuse.start_as_current_span(name="langchain-call"):
    # Propagate user_id to all spans
    with propagate_attributes(user_id="user_12345"):
        # Pass handler to the chain invocation
        chain.invoke(
            {"animal": "dog"},
            config={"callbacks": [handler]},
        )
```

</Tab>
<Tab title="Langchain (JS/TS)">

Use `propagateAttributes()` with the CallbackHandler:

```ts
import { startActiveObservation, propagateAttributes } from "@langfuse/tracing";
import { CallbackHandler } from "langfuse-langchain";

const langfuseHandler = new CallbackHandler();

await startActiveObservation("langchain-call", async () => {
  // Propagate userId to all spans
  await propagateAttributes({
    userId: "user-123",
  }, async () => {
    // Pass handler to the chain invocation
    await chain.invoke(
      { input: "<user_input>" },
      { callbacks: [langfuseHandler] }
    );
  });
});
```

</Tab>

<Tab title="Flowise">
You can set the `userId` via the override configs, see the [Flowise Integration docs](/docs/flowise) for more details.

</Tab>

</LangTabs>

<PropagationRestrictionsCallout attributes={["userId"]} />

## View all users

The user list provides an overview of all users that have been tracked by Langfuse. It makes it simple to segment by overall token usage, number of traces, and user feedback.

<Frame fullWidth>![User List](/images/docs/users-list.png)</Frame>

## Individual user view

The individual user view provides an in-depth look into a single user. Explore aggregated metrics or view all traces and feedback for a user.

<Video
  src="https://static.langfuse.com/docs-videos/user-table.mp4"
  aspectRatio={1592 / 1080}
  gifStyle
/>

You can deep link to this view via the following URL format: `https://<hostname>/project/{projectId}/users/{userId}`

## GitHub Discussions

import { GhDiscussionsPreview } from "@/components/gh-discussions/GhDiscussionsPreview";

<GhDiscussionsPreview labels={["feat-users"]} />
